<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blender Addon Details</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="../style.css">
</head>

<body>
  <div class="wrapper">
    <!-- Sidebar -->
    <aside class="left-sidebar">
      <div class="sidebar-header">
        <h3>KOKI<span>VFX & 3D</span></h3>
        <p class="tagline">Premium VFX & 3D Assets</p>
      </div>

      <nav class="sidebar-nav">
        <ul class="sidebar-menu">
          <li><a href="../index.html">Home</a></li>
          <li><a href="../Membership/membership.html">Membership</a></li>

          <!-- Blender Dropdown -->
          <li class="dropdown-item active">
            <a href="#" class="dropdown-toggle" onclick="toggleSubmenu(event)">
              Blender
              <i class="fas fa-chevron-right chevron"></i>
            </a>
            <ul class="submenu open">
              <li><a href="blender-addons.html">Add-ons</a></li>
              <li><a href="blender-assets.html">Assets</a></li>
              <li><a href="blender-3d.html">3D Models</a></li>
            </ul>
          </li>

          <!-- Unreal Dropdown -->
          <li class="dropdown-item">
            <a href="#" class="dropdown-toggle" onclick="toggleSubmenu(event)">
              Unreal
              <i class="fas fa-chevron-right chevron"></i>
            </a>
            <ul class="submenu">
              <li><a href="../Unreal/unreal-plugins.html">Plugins</a></li>
              <li><a href="../Unreal/unreal-assets.html">Assets</a></li>
              <li><a href="../Unreal/unreal-3d.html">3D Models</a></li>
            </ul>
          </li>

          <!-- After Effects Dropdown -->
          <li class="dropdown-item">
            <a href="#" class="dropdown-toggle" onclick="toggleSubmenu(event)">
              After Effects
              <i class="fas fa-chevron-right chevron"></i>
            </a>
            <ul class="submenu">
              <li><a href="../ae/ae-templates.html">Templates</a></li>
              <li><a href="../ae/ae-presets.html">Presets</a></li>
              <li><a href="../ae/ae-assets.html">Assets</a></li>
            </ul>
          </li>

          <!-- Premiere Pro Dropdown -->
          <li class="dropdown-item">
            <a href="#" class="dropdown-toggle" onclick="toggleSubmenu(event)">
              Premiere Pro
              <i class="fas fa-chevron-right chevron"></i>
            </a>
            <ul class="submenu">
              <li><a href="../pr/pp-templates.html">Templates</a></li>
              <li><a href="../pr/pp-presets.html">Presets</a></li>
              <li><a href="../pr/pp-assets.html">Assets</a></li>
            </ul>
          </li>

          <!-- Photoshop Dropdown -->
          <li class="dropdown-item">
            <a href="#" class="dropdown-toggle" onclick="toggleSubmenu(event)">
              Photoshop
              <i class="fas fa-chevron-right chevron"></i>
            </a>
            <ul class="submenu">
              <li><a href="../ps/psd-templates.html">PSD Templates</a></li>
              <li><a href="../ps/ps-brushes.html">Brushes</a></li>
              <li><a href="../ps/ps-actions.html">Actions</a></li>
            </ul>
          </li>

          <!-- Houdini Single Item -->
          <li>
            <a href="../Houdini/houdini.html">
              Houdini
            </a>
          </li>

          <!-- Website Templates Single Item -->
          <li>
            <a href="../web template/website-templates.html">
              Website Templates
            </a>
          </li>

          <!-- Software Single Item -->
          <li>
            <a href="../Softwear/software.html">
              Software
            </a>
          </li>
        </ul>
      </nav>
    </aside>

    <!-- Main -->
    <div class="main-wrapper">
      <header class="header">
        <div class="search-box">
          <i class="fas fa-search search-icon"></i>
          <input type="text" placeholder="Search for assets, templates, plugins...">
          <button><i class="fas fa-search"></i></button>
        </div>
      </header>

      <main class="main-content">
        <div style="max-width: 1400px; margin: 40px auto; padding: 0 20px;">
          <a href="blender-addons.html" style="color: #5db8ff; text-decoration: none; display: inline-flex; align-items: center; gap: 8px; margin-bottom: 20px;">
            <i class="fas fa-arrow-left"></i> Back to Add-ons
          </a>
          
          <div id="addonDetail" style="background: rgba(255, 255, 255, 0.08); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.15); border-radius: 12px; padding: 30px; margin-top: 20px;">
            <!-- Content will be loaded dynamically -->
          </div>

          <!-- Related Addons Slideshow -->
          <div style="margin-top: 50px;">
            <h2 style="color: #fff; font-size: 24px; margin-bottom: 25px;">More Addons for You!</h2>
            <div class="slideshow-container" style="position: relative; overflow: hidden; border-radius: 12px; background: rgba(255, 255, 255, 0.05); padding: 20px 60px;">
              <div class="slideshow-track" id="slideshowTrack" style="display: flex; transition: transform 0.5s ease-in-out;">
                <!-- Slides will be added dynamically -->
              </div>
              <button class="slide-btn prev" onclick="moveSlide(-1)" style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%); background: rgba(0, 0, 0, 0.7); border: 1px solid rgba(255, 255, 255, 0.2); color: #fff; padding: 15px 12px; cursor: pointer; border-radius: 50%; font-size: 18px; z-index: 10; transition: all 0.3s ease;">
                <i class="fas fa-chevron-left"></i>
              </button>
              <button class="slide-btn next" onclick="moveSlide(1)" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: rgba(0, 0, 0, 0.7); border: 1px solid rgba(255, 255, 255, 0.2); color: #fff; padding: 15px 12px; cursor: pointer; border-radius: 50%; font-size: 18px; z-index: 10; transition: all 0.3s ease;">
                <i class="fas fa-chevron-right"></i>
              </button>
            </div>
          </div>
        </div>
      </main>
    </div>
  </div>

  <script src="../script.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      const params = new URLSearchParams(window.location.search);
      const addonId = parseInt(params.get('id'));
      const addon = products.find(p => p.id === addonId);
      
      if (!addon) {
        document.getElementById('addonDetail').innerHTML = '<p style="color: rgba(255,255,255,0.7); text-align: center;">Addon not found.</p>';
        return;
      }
      
      // Get current date for upload date
      const uploadDate = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
      
      // Get or initialize view count from localStorage
      const viewsKey = `addon_views_${addonId}`;
      let viewCount = parseInt(localStorage.getItem(viewsKey) || '0');
      viewCount++;
      localStorage.setItem(viewsKey, viewCount);
      
      document.getElementById('addonDetail').innerHTML = `
        <div style="display: flex; gap: 30px; flex-wrap: wrap;">
          <div style="flex: 1; min-width: 400px;">
            <img src="../${addon.image}" alt="${addon.title}" style="width: 100%; border-radius: 8px;" loading="lazy" onerror="this.src='../backgrounds/theme.jpg'">
          </div>
          
          <div style="flex: 1; min-width: 300px;">
            <h1 style="color: #fff; font-size: 28px; margin: 0 0 20px 0;">${addon.title}</h1>
            
            <div style="margin: 20px 0;">
              <p style="color: rgba(255, 255, 255, 0.6); font-size: 14px; margin: 8px 0;">
                <i class="fas fa-calendar-alt" style="margin-right: 8px;"></i>
                Upload Date: ${uploadDate}
              </p>
              <p style="color: rgba(255, 255, 255, 0.6); font-size: 14px; margin: 8px 0;">
                <i class="fas fa-eye" style="margin-right: 8px;"></i>
                Views: ${viewCount.toLocaleString()}
              </p>
            </div>
            
            <div style="margin: 30px 0;">
              <p style="color: rgba(255, 255, 255, 0.95); font-size: 16px; line-height: 1.8;">
                ${addon.description}
              </p>
            </div>
            
            <a href="${addon.download}" target="_blank" style="display: block; width: 100%; padding: 15px; background: #5db8ff; color: #000; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; text-align: center; text-decoration: none;" onmouseover="this.style.background='#4da3e6'" onmouseout="this.style.background='#5db8ff'">
              <i class="fas fa-download" style="margin-right: 8px;"></i>Download Now
            </a>
          </div>
        </div>
      `;
      
      // Load slideshow with related addons
      loadSlideshow(addonId);
    });
    
    let currentSlide = 0;
    let slidesPerView = window.innerWidth >= 1200 ? 4 : window.innerWidth >= 768 ? 3 : window.innerWidth >= 480 ? 2 : 1;
    let relatedAddons = [];
    
    // Fisher-Yates shuffle algorithm for random order
    function shuffleArray(array) {
      const shuffled = [...array];
      for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
      }
      return shuffled;
    }
    
    function loadSlideshow(currentAddonId) {
      // Get all blender addons except current one
      relatedAddons = products.filter(p => p.category === 'blender-addons' && p.id !== currentAddonId);
      
      // Shuffle array to show random addons
      relatedAddons = shuffleArray(relatedAddons);
      
      const track = document.getElementById('slideshowTrack');
      track.innerHTML = '';
      
      relatedAddons.forEach(addon => {
        const slide = document.createElement('div');
        slide.className = 'slide-item';
        slide.style.cssText = `
          min-width: ${100 / slidesPerView}%;
          padding: 15px;
          box-sizing: border-box;
        `;
        
        slide.innerHTML = `
          <div onclick="window.location.href='addon-detail.html?id=${addon.id}'" style="
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
          " onmouseover="this.style.transform='translateY(-5px)'; this.style.borderColor='rgba(93, 184, 255, 0.5)'" onmouseout="this.style.transform='translateY(0)'; this.style.borderColor='rgba(255, 255, 255, 0.15)'">
            <img src="../${addon.image}" alt="${addon.title}" style="width: 100%; height: 180px; object-fit: cover;" loading="lazy" onerror="this.src='../backgrounds/theme.jpg'">
            <div style="padding: 15px;">
              <h3 style="color: #fff; font-size: 16px; margin: 0 0 8px 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${addon.title}</h3>
              <p style="color: rgba(255, 255, 255, 0.6); font-size: 13px; margin: 0; overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical;">${addon.description}</p>
            </div>
          </div>
        `;
        
        track.appendChild(slide);
      });
      
      updateSlidePosition();
      
      // Auto-play slideshow every 5 seconds
      setInterval(() => moveSlide(1), 5000);
    }
    
    function moveSlide(direction) {
      const maxSlides = Math.max(0, relatedAddons.length - slidesPerView);
      currentSlide += direction;
      
      if (currentSlide < 0) {
        currentSlide = maxSlides;
      } else if (currentSlide > maxSlides) {
        currentSlide = 0;
      }
      
      updateSlidePosition();
    }
    
    function updateSlidePosition() {
      const track = document.getElementById('slideshowTrack');
      const offset = -(currentSlide * (100 / slidesPerView));
      track.style.transform = `translateX(${offset}%)`;
    }
    
    // Update slides per view on window resize
    window.addEventListener('resize', () => {
      const newSlidesPerView = window.innerWidth >= 1200 ? 4 : window.innerWidth >= 768 ? 3 : window.innerWidth >= 480 ? 2 : 1;
      if (newSlidesPerView !== slidesPerView) {
        slidesPerView = newSlidesPerView;
        currentSlide = 0;
        updateSlidePosition();
      }
    });
  </script>
</body>
</html>
