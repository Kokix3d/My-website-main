<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Asset Details | KOKI VFX & 3D</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="../style.css">
</head>

<body>
  <div class="wrapper">
    <!-- Sidebar -->
    <aside class="left-sidebar">
      <div class="sidebar-header">
        <h3>KOKI<span>VFX & 3D</span></h3>
        <p class="tagline">Premium VFX & 3D Assets</p>
      </div>

      <nav class="sidebar-nav">
        <ul class="sidebar-menu">
          <li><a href="../index.html">Home</a></li>
          <li><a href="../Membership/membership.html">Membership</a></li>

          <!-- Blender Dropdown -->
          <li class="dropdown-item active">
            <a href="blender.html" class="dropdown-toggle">
              Blender
              <i class="fas fa-chevron-right chevron"></i>
            </a>
            <ul class="submenu open">
              <li><a href="../Blender/blender-addons.html">Add-ons</a></li>
              <li><a href="../Blender/blender-assets.html">Assets</a></li>
              <li><a href="../Blender/blender-3d.html">3D Models</a></li>
            </ul>
          </li>

          <!-- Unreal Dropdown -->
          <li class="dropdown-item">
            <a href="#" class="dropdown-toggle" onclick="toggleSubmenu(event)">
              Unreal
              <i class="fas fa-chevron-right chevron"></i>
            </a>
            <ul class="submenu">
              <li><a href="../Unreal/unreal-plugins.html">Plugins</a></li>
              <li><a href="../Unreal/unreal-assets.html">Assets</a></li>
              <li><a href="../Unreal/unreal-3d.html">3D Models</a></li>
            </ul>
          </li>

          <!-- After Effects Dropdown -->
          <li class="dropdown-item">
            <a href="#" class="dropdown-toggle" onclick="toggleSubmenu(event)">
              After Effects
              <i class="fas fa-chevron-right chevron"></i>
            </a>
            <ul class="submenu">
              <li><a href="../ae/ae-templates.html">Templates</a></li>
              <li><a href="../ae/ae-presets.html">Presets</a></li>
              <li><a href="../ae/ae-assets.html">Assets</a></li>
            </ul>
          </li>

          <!-- Premiere Pro Dropdown -->
          <li class="dropdown-item">
            <a href="#" class="dropdown-toggle" onclick="toggleSubmenu(event)">
              Premiere Pro
              <i class="fas fa-chevron-right chevron"></i>
            </a>
            <ul class="submenu">
              <li><a href="../pr/pp-templates.html">Templates</a></li>
              <li><a href="../pr/pp-presets.html">Presets</a></li>
              <li><a href="../pr/pp-assets.html">Assets</a></li>
            </ul>
          </li>

          <!-- Photoshop Dropdown -->
          <li class="dropdown-item">
            <a href="#" class="dropdown-toggle" onclick="toggleSubmenu(event)">
              Photoshop
              <i class="fas fa-chevron-right chevron"></i>
            </a>
            <ul class="submenu">
              <li><a href="../ps/psd-templates.html">PSD Templates</a></li>
              <li><a href="../ps/ps-brushes.html">Brushes</a></li>
              <li><a href="../ps/ps-actions.html">Actions</a></li>
            </ul>
          </li>

          <!-- Houdini Single Item -->
          <li>
            <a href="../Houdini/houdini.html">
              Houdini
            </a>
          </li>

          <!-- Website Templates Single Item -->
          <li>
            <a href="../web template/website-templates.html">
              Website Templates
            </a>
          </li>

          <!-- Software Single Item -->
          <li>
            <a href="../Softwear/software.html">
              Software
            </a>
          </li>
        </ul>
      </nav>
    </aside>

    <!-- Main -->
    <div class="main-wrapper">
      <header class="header">
        <div class="search-box">
          <input type="text" placeholder="Search...">
          <button></button>
        </div>
      </header>

      <main class="main-content">
        <div style="max-width: 1400px; margin: 40px auto; padding: 0 20px;">
          <a href="blender-assets.html" style="color: #5db8ff; text-decoration: none; display: inline-flex; align-items: center; gap: 8px; margin-bottom: 20px;">
            <i class="fas fa-arrow-left"></i> Back to Assets
          </a>
          
          <div id="assetDetail" style="background: rgba(255, 255, 255, 0.08); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.15); border-radius: 12px; padding: 30px; margin-top: 20px;">
            <!-- Content will be loaded dynamically -->
          </div>

          <!-- Related Assets Slideshow -->
          <div style="margin-top: 50px;">
            <h2 style="color: #fff; font-size: 24px; margin-bottom: 25px;">More Assets for You!</h2>
            <div class="slideshow-container" style="position: relative; overflow: hidden; border-radius: 12px; background: rgba(255, 255, 255, 0.05);">
              <div class="slideshow-track" id="slideshowTrack" style="display: flex; transition: transform 0.5s ease-in-out;">
                <!-- Slides will be added dynamically -->
              </div>
              <button class="slideshow-btn prev" onclick="prevSlide()" style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%); background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); color: #fff; padding: 15px 20px; cursor: pointer; border-radius: 8px; font-size: 18px; z-index: 10; transition: all 0.3s;">
                <i class="fas fa-chevron-left"></i>
              </button>
              <button class="slideshow-btn next" onclick="nextSlide()" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); color: #fff; padding: 15px 20px; cursor: pointer; border-radius: 8px; font-size: 18px; z-index: 10; transition: all 0.3s;">
                <i class="fas fa-chevron-right"></i>
              </button>
            </div>
          </div>
        </div>
      </main>
    </div>
  </div>

  <script src="../script.js"></script>
  <script>
    // Slideshow variables
    let currentSlide = 0;
    let slidesPerView = window.innerWidth >= 1200 ? 4 : window.innerWidth >= 768 ? 3 : window.innerWidth >= 480 ? 2 : 1;
    let relatedAssets = [];
    
    // Fisher-Yates shuffle algorithm for random order
    function shuffleArray(array) {
      const shuffled = [...array];
      for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
      }
      return shuffled;
    }
    
    function loadSlideshow(currentAssetId) {
      // Get all blender assets except current one
      relatedAssets = products.filter(p => p.category === 'blender-assets' && p.id !== currentAssetId);
      
      // Shuffle array to show random assets
      relatedAssets = shuffleArray(relatedAssets);
      
      const track = document.getElementById('slideshowTrack');
      track.innerHTML = '';
      
      relatedAssets.forEach(asset => {
        const slide = document.createElement('div');
        slide.style.cssText = `
          min-width: calc(${100/slidesPerView}% - 20px);
          margin: 10px;
          background: rgba(255, 255, 255, 0.08);
          border: 1px solid rgba(255, 255, 255, 0.15);
          border-radius: 12px;
          overflow: hidden;
          cursor: pointer;
          transition: all 0.3s ease;
        `;
        
        slide.onmouseover = function() {
          this.style.transform = 'translateY(-5px)';
          this.style.borderColor = '#5db8ff';
        };
        slide.onmouseout = function() {
          this.style.transform = 'translateY(0)';
          this.style.borderColor = 'rgba(255, 255, 255, 0.15)';
        };
        
        slide.onclick = function() {
          window.location.href = `asset-detail.html?id=${asset.id}`;
        };
        
        slide.innerHTML = `
          <img src="../${asset.image}" alt="${asset.title}" style="width: 100%; height: 200px; object-fit: cover;" loading="lazy" onerror="this.src='../backgrounds/theme.jpg'">
          <div style="padding: 15px;">
            <h3 style="color: #fff; font-size: 16px; margin: 0 0 8px 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${asset.title}</h3>
            <p style="color: rgba(255, 255, 255, 0.7); font-size: 13px; margin: 0; overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical;">${asset.description}</p>
          </div>
        `;
        
        track.appendChild(slide);
      });
      
      updateSlideshow();
    }
    
    function updateSlideshow() {
      const track = document.getElementById('slideshowTrack');
      const offset = -(currentSlide * (100 / slidesPerView));
      track.style.transform = `translateX(${offset}%)`;
    }
    
    function nextSlide() {
      const maxSlides = Math.ceil(relatedAssets.length / slidesPerView) - 1;
      if (currentSlide < maxSlides) {
        currentSlide++;
        updateSlideshow();
      }
    }
    
    function prevSlide() {
      if (currentSlide > 0) {
        currentSlide--;
        updateSlideshow();
      }
    }
    
    // Auto-play slideshow
    setInterval(() => {
      const maxSlides = Math.ceil(relatedAssets.length / slidesPerView) - 1;
      if (currentSlide >= maxSlides) {
        currentSlide = 0;
      } else {
        currentSlide++;
      }
      updateSlideshow();
    }, 5000);
    
    // Responsive slideshow
    window.addEventListener('resize', () => {
      const newSlidesPerView = window.innerWidth >= 1200 ? 4 : window.innerWidth >= 768 ? 3 : window.innerWidth >= 480 ? 2 : 1;
      if (newSlidesPerView !== slidesPerView) {
        slidesPerView = newSlidesPerView;
        currentSlide = 0;
        updateSlideshow();
      }
    });
    
    // Load asset details
    document.addEventListener("DOMContentLoaded", function() {
      const urlParams = new URLSearchParams(window.location.search);
      const assetId = parseInt(urlParams.get('id'));
      
      const asset = products.find(p => p.id === assetId);
      
      if (!asset) {
        document.getElementById('assetDetail').innerHTML = '<p style="color: rgba(255,255,255,0.7); text-align: center; padding: 40px;">Asset not found.</p>';
        return;
      }
      
      // Get upload date (using current date as placeholder)
      const uploadDate = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
      
      // View counter
      const viewsKey = `asset_views_${assetId}`;
      let viewCount = parseInt(localStorage.getItem(viewsKey) || '0');
      viewCount++;
      localStorage.setItem(viewsKey, viewCount);
      
      document.getElementById('assetDetail').innerHTML = `
        <div style="display: flex; gap: 30px; flex-wrap: wrap;">
          <div style="flex: 1; min-width: 400px;">
            <img src="../${asset.image}" alt="${asset.title}" style="width: 100%; border-radius: 8px;" loading="lazy" onerror="this.src='../backgrounds/theme.jpg'">
          </div>
          
          <div style="flex: 1; min-width: 300px;">
            <h1 style="color: #fff; font-size: 28px; margin: 0 0 20px 0;">${asset.title}</h1>
            
            <div style="margin: 20px 0;">
              <p style="color: rgba(255, 255, 255, 0.6); font-size: 14px; margin: 8px 0;">
                <i class="fas fa-calendar-alt" style="margin-right: 8px;"></i>
                Upload Date: ${uploadDate}
              </p>
              <p style="color: rgba(255, 255, 255, 0.6); font-size: 14px; margin: 8px 0;">
                <i class="fas fa-eye" style="margin-right: 8px;"></i>
                Views: ${viewCount.toLocaleString()}
              </p>
            </div>
            
            <p style="color: rgba(255, 255, 255, 0.8); line-height: 1.6; margin: 20px 0;">${asset.description}</p>
            
            <a href="${asset.download}" target="_blank" style="display: inline-block; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #fff; padding: 15px 40px; border-radius: 8px; text-decoration: none; font-weight: 600; margin-top: 20px; transition: all 0.3s; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);">
              <i class="fas fa-download" style="margin-right: 8px;"></i> Download Now
            </a>
          </div>
        </div>
      `;
      
      // Load related assets slideshow
      loadSlideshow(assetId);
    });
    
    // Hover effect for slideshow buttons
    const buttons = document.querySelectorAll('.slideshow-btn');
    buttons.forEach(btn => {
      btn.addEventListener('mouseover', function() {
        this.style.background = 'rgba(91, 184, 255, 0.3)';
        this.style.borderColor = '#5db8ff';
      });
      btn.addEventListener('mouseout', function() {
        this.style.background = 'rgba(255, 255, 255, 0.1)';
        this.style.borderColor = 'rgba(255, 255, 255, 0.2)';
      });
    });
  </script>
</body>
</html>
